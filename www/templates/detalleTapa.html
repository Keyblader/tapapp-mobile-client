<ion-view style="" title="Detalla Tapa"> 
<ion-content class="has-header" padding="true">

<article class="detalle container col-md-12">

		
		<!-- FAVORITO -->
		<div ng-if="favorito == 'true'">
			<a href ng-click='cambiarEstado()'>
	        	<div class="favorito pull-right"></div>
        	</a> 
		</div>
        
        <div ng-if="favorito == 'false'">
			<a href ng-click='cambiarEstado()'>
	        	<div class="favorito-no pull-right"></div>
        	</a> 
		</div>
        

		<!-- SLIDER -->
		<div class="slider">
			<div ng-if='fotos.length <= 0'>
				<img ng-src="http://kaerzas.pythonanywhere.com{{tapa.imagen}}">
			</div>
			
			<div ng-if='fotos.length > 0'>
			<ion-slide-box on-slide-changed="slideHasChanged($index)">
				<ion-slide ng-repeat="foto in fotos">
					<img ng-src="http://kaerzas.pythonanywhere.com{{foto.imagen}}">
				</ion-slide>
			</ion-slide-box>
			</div>
		</div>
		<!-- /SLIDER -->



		<div id="detalle" class="container col-xs-12">
            <div id="texto" class="col-xs-offset-3">
                <p class="puntuacion pull-left">{{ tapa.puntuacionMedia }}</p>
                <h2>{{ tapa.nombre }}</h2>
                <p><a href="/#/app/detalleBar/{{bar.id}}"><small>{{bar.nombre}}</small></a></p>
                <p><small>{{ usuarioRegistro.username }}</small></p>
                <p id="descripcion" class="descripcion-tapa">{{tapa.descripcion}}</p>
            </div>
        </div>
	        
	        
	        
	    <!-- OPCIONES -->
	    <div id="opciones" class="container col-xs-12">
	    
		    <!-- PUNTUAR -->
		    <div id="puntuacion" class="col-xs-12 text-center">
		    <!-- TODO: revisar ya que siempre pone el valor del ultimo (el 1) -->
		    
	   			<form class="starRating" name="valoracionForm" >
					<input id="rating5" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-click='guardarValoracion("5")'>
					<label for="rating5">5</label>
					<input id="rating4" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-click='guardarValoracion("4")'>
					<label for="rating4">4</label>
					<input id="rating3" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-click='guardarValoracion("3")'>
					<label for="rating3">3</label>
					<input id="rating2" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-click='guardarValoracion("2")'>
					<label for="rating2">2</label>
					<input id="rating1" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-click='guardarValoracion("1")'>
					<label for="rating1">1</label>
				</form>
		    
		    
                <!-- <form class="starRating" action="" method="post">
                    <input id="rating5" type="submit" name="rating" value="5">
                    <label for="rating5">5</label>
                    <input id="rating4" type="submit" name="rating" value="4">
                    <label for="rating4">4</label>
                    <input id="rating3" type="submit" name="rating" value="3">
                    <label for="rating3">3</label>
                    <input id="rating2" type="submit" name="rating" value="2">
                    <label for="rating2">2</label>
                    <input id="rating1" type="submit" name="rating" value="1">
                    <label for="rating1">1</label>
                </form> -->
            </div>
		    	
		    <!-- MAPA -->
		    <!-- TODO: explota, manda a login ï¿½? -->
		    <ng-map class="mapa" center="{{centro}}">
    			<marker position="{{centro}}"></marker>
    		</ng-map>
    		
            <!-- Desplegar mapa -->
	        <div class="map-buttons col-xs-12">
	        	<a class="button-map" href="#" ng-click="abrirGoogleMaps()"> Abrir en google maps</a>
	            <!-- <a class="button-map" class="btn" data-toggle="collapse" href="#collapseExample" aria-expanded="false"
	               aria-controls="collapseExample" onclick="document.getElementById('collapseExample').style.visibility = 'visible'">
	                Localizar en el mapa
	            </a> -->
	        </div>
		        
	    </div>
	    <!-- /OPCIONES -->
	    
	    
	    <!-- COMENTARIOS -->
	    <div id="comentarios" class="container col-xs-12" style="padding:0;">
	    <div id="add-comentario" class="add">
	    
    		<h3>Comentarios:</h3>
        	<div ng-repeat="comentario in comentarios">
	            <div class="comentario">
	                <p class="autor-comentario">{{ comentario.usuario }}<small> ({{ comentario.fechaSubida }}):</small></p>
	                <p class="texto-comentario">{{ comentario.descripcion }}</p>
	            </div>
            </div>
            
            <!-- TODO: corregir el formulario para que funcione -->
			<form name="comentarioForm" ng-controller="detalleTapaCtrl" novalidate>
				<div class="list">
				  <label class="item item-input">
				    <input name="descripcion" type="text" ng-model="comentario.descripcion" ng-model-options="{ updateOn: 'blur' }" required placeholder="Nuevo comentario">
				  </label>
				</div>
				<span class="messages" ng-show="comentarioForm.$submitted || comentarioForm.descripcion.$touched">
					<span ng-show="comentarioForm.descripcion.$error.required">El campo es obligatorio.</span>
				</span>
				<input type="submit"  class="button button-full button-positive" ng-click="guardarComentario(comentario)" value="Enviar comentario" ng-disabled="comentarioForm.$invalid" />
			</form>
			
		</div>
        </div>



</article>
    
</ion-content> 
</ion-view>

<!-- Menu inferior -->
<div class="tabs tabs-icon-only">
  <a class="tab-item">
    <div id="add-comment" class="floating-button btn" onclick="bottom()"></div>
  </a>
  <a class="tab-item">
	<div id="add-foto" class="floating-button btn">
		<!-- TODO: Añadir foto -->
	</div>
  </a>
</div>
<!-- /Menu inferior -->




    <!-- Slider de fotos -->
    <!-- TODO: creo que no lo reconoce -->
    <script type="text/javascript">
        var slider = new IdealImageSlider.Slider({
            selector: '#slider',
            height: 400,
            interval: 4000
        });
        slider.start();
    </script>

