<ion-view style="" title="Detalla Tapa"> 
<ion-content class="has-header" padding="true">

<article class="detalle container col-md-12">

		
		<!-- FAVORITO -->
		<!-- TODO: Debe recibir si la tapa es favorita del usuario actual o no -->
		<!-- TODO: Debe crearse la vista anyadirFavorito -->
        <a href="/tapas/anyadirFavorito/{{ tapa.id }}/">
	        <div class="favorito pull-right"></div>
	        <div class="favorito-no pull-right"></div>
        </a>

<!-- 	<h1>Nombre: {{tapa.nombre}}</h1>
	 Si te fijas la imagen la recibe
	<div class="img col-xs-5 col-md-4"
		style="background-image: url('http://localhost:8000{{tapa.imagen}}');">
		<p class="favorito pull-right"></p>
	</div>  -->


        
		<!-- SLIDER -->
		<div ng-if='fotos.length <= 0'>
			<img ng-src="http://localhost:8000{{tapa.imagen}}">
		</div>
		
		<div ng-if='fotos.length > 0'>
		<ion-slide-box on-slide-changed="slideHasChanged($index)">
			<ion-slide ng-repeat="foto in fotos">
				<img ng-src="http://localhost:8000{{foto.imagen}}">
			</ion-slide>
		</ion-slide-box>
		</div>
		<!-- /SLIDER -->



		<div id="detalle" class="container col-xs-12">
            <div id="texto" class="col-xs-offset-3">
                <p class="puntuacion pull-left">{{ tapa.puntuacionMedia }}</p>
                <h2>{{ tapa.nombre }}</h2>
                <p><a href="/#/app/detalleBar/{{bar.id}}"><small>{{bar.nombre}}</small></a></p>
                <p><small>{{ usuarioRegistro.username }}</small></p>
                <p id="descripcion" class="descripcion-tapa">{{tapa.descripcion}}</p>
            </div>
        </div>
	        
	        
	        
	    <!-- OPCIONES -->
	    <div id="opciones" class="container col-xs-12">
	    
		    <!-- PUNTUAR -->
		    <div id="puntuacion" class="col-xs-12 text-center">
		    <!-- TODO: revisar ya que siempre pone el valor del ultimo (el 1) -->
		    
	   			<form class="starRating" name="valoracionForm" >
					<input id="rating5" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-init="valoracion.puntuacion=5" ng-click="guardarValoracion(valoracion)">
					<label for="rating5">5</label>
					<input id="rating4" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-init="valoracion.puntuacion=4" ng-click="guardarValoracion(valoracion)">
					<label for="rating4">4</label>
					<input id="rating3" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-init="valoracion.puntuacion=3" ng-click="guardarValoracion(valoracion)">
					<label for="rating3">3</label>
					<input id="rating2" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-init="valoracion.puntuacion=2" ng-click="guardarValoracion(valoracion)">
					<label for="rating2">2</label>
					<input id="rating1" type="submit" name="rating" ng-model="valoracion.puntuacion" ng-init="valoracion.puntuacion=1" ng-click="guardarValoracion(valoracion)">
					<label for="rating1">1</label>
				</form>
		    
		    
                <!-- <form class="starRating" action="" method="post">
                    <input id="rating5" type="submit" name="rating" value="5">
                    <label for="rating5">5</label>
                    <input id="rating4" type="submit" name="rating" value="4">
                    <label for="rating4">4</label>
                    <input id="rating3" type="submit" name="rating" value="3">
                    <label for="rating3">3</label>
                    <input id="rating2" type="submit" name="rating" value="2">
                    <label for="rating2">2</label>
                    <input id="rating1" type="submit" name="rating" value="1">
                    <label for="rating1">1</label>
                </form> -->
            </div>
		    	
		    <!-- MAPA -->
		    <!-- TODO: explota, manda a login ï¿½? -->
            <!-- Desplegar mapa -->
	        <p class="col-xs-12">
	            <a id="button-map" class="btn" data-toggle="collapse" href="#collapseExample" aria-expanded="false"
	               aria-controls="collapseExample" onclick="document.getElementById('collapseExample').style.visibility = 'visible'">
	                Localizar en el mapa
	            </a>
	        </p>
	
	        <!-- Desplegar mapa -->
	        <div class="col-xs-12" id="collapseExample" style="height: 0; visibility: hidden; margin-top: 0">
	            <div id="mapa"></div>
	        </div>
		        
	    </div>
	    <!-- /OPCIONES -->
	    
	    
	    <!-- COMENTARIOS -->
	    <div id="comentarios" class="container col-xs-12">
	    <div id="add-comentario" class="add">
	    
    		<h3>Comentarios:</h3>
        	<div ng-repeat="comentario in comentarios">
	            <div class="comentario">
	                <p class="autor-comentario">{{ comentario.usuario }}<small> ({{ comentario.fechaSubida }}):</small></p>
	                <p class="texto-comentario">{{ comentario.descripcion }}</p>
	            </div>
            </div>
            <!-- TODO: corregir el formulario para que funcione -->
			<form name="comentarioForm" ng-controller="detalleTapaCtrl" novalidate>
				<label for="descripcion">Nuevo: </label><br /> 
				<input name="descripcion" type="text" ng-model="comentario.descripcion" ng-model-options="{ updateOn: 'blur' }" required />
				<span class="messages" ng-show="comentarioForm.$submitted || comentarioForm.descripcion.$touched">
					<span ng-show="comentarioForm.descripcion.$error.required">El campo es obligatorio.</span>
				</span>
				<input type="submit" ng-click="guardarComentario(comentario)" value="Guardar" ng-disabled="comentarioForm.$invalid" />
			</form>
		</div>
        </div>



</article>
    
</ion-content> 
</ion-view>


    <!-- Slider de fotos -->
    <!-- TODO: creo que no lo reconoce -->
    <script type="text/javascript">
        var slider = new IdealImageSlider.Slider({
            selector: '.slider',
            height: 400,
            interval: 4000
        });
        slider.start();
    </script>

